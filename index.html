<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<title>수상한 동아리 — 인터랙티브 스토리</title>
<style>
  :root{
    --bg:#0d0d14;
    --panel:#14161d;
    --accent:#68d4ff;
    --muted:#c8ccd2;
    --danger:#ff6b81;
  }
  html,body{
    height:100%;margin:0;
    font-family:Inter, "Noto Sans KR", system-ui;
    background:linear-gradient(180deg,#070710 0%, #161821 100%);
    color:#fff;
    -webkit-font-smoothing:antialiased;
  }
  .app{display:flex;flex-direction:column;height:100vh;padding:16px;box-sizing:border-box;max-width:900px;margin:0 auto;}
  header{display:flex;align-items:center;gap:12px;}
  .logo{
    width:56px;height:56px;border-radius:12px;
    background:linear-gradient(135deg,#4ac9ff,#2196f3);
    display:flex;align-items:center;justify-content:center;
    font-weight:800;color:#222;font-size:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.5);
  }
  h1{font-size:18px;margin:0;letter-spacing:0.2px;}
  .meta{margin-left:auto;text-align:right;font-size:12px;color:var(--muted);}
  main{flex:1;display:flex;flex-direction:column;gap:12px;margin-top:12px;}
  .panel{
    background:var(--panel);
    border-radius:16px;padding:16px;
    box-shadow:0 12px 40px rgba(0,0,0,0.5);
    display:flex;flex-direction:column;
  }
  #story{flex:1;min-height:260px;font-size:16px;line-height:1.8;white-space:pre-wrap;transition:opacity .28s ease;}
  #choices{display:flex;flex-direction:column;gap:10px;margin-top:12px;}
  .choice{
    padding:14px;border-radius:14px;
    background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.05);
    font-size:16px;text-align:left;cursor:pointer;
    box-shadow:0 8px 24px rgba(0,0,0,0.35);
    color:#fff;width:100%;
  }
  .choice:active{transform:translateY(2px);}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .stat{font-size:13px;color:var(--muted);padding:8px 12px;border-radius:999px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.05);}
  footer{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:12px;}
  .btn{padding:10px 12px;border-radius:10px;background:var(--accent);color:#222;font-weight:800;border:none;cursor:pointer;box-shadow:0 10px 20px rgba(104,212,255,0.12);}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);}
  .smalltext{font-size:12px;color:var(--muted);}
  .log{max-height:140px;overflow:auto;padding:10px;border-radius:12px;background:rgba(255,255,255,0.02);font-size:13px;color:var(--muted);margin-top:12px;}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="logo">SC</div>
    <h1>수상한 동아리 — 인터랙티브 스토리</h1>
    <div class="meta">
      <div id="timePlayed">플레이: 0초</div>
      <div id="progressText">진행: 0%</div>
    </div>
  </header>

  <main>
    <section class="panel" style="flex:1;display:flex;flex-direction:column;">
      <div id="story" aria-live="polite"></div>
      <div id="choices"></div>
      <div class="log" id="log"></div>
    </section>

    <section style="display:flex;flex-direction:column;gap:10px;">
      <div class="row">
        <div class="stat" id="statTrust">신뢰도: 0</div>
        <div class="stat" id="statClues">단서: 0</div>
        <div class="stat" id="statAlert">감시레벨: 0</div>
      </div>
      <div class="row">
        <button class="btn ghost" id="restartBtn">처음부터</button>
        <button class="btn ghost" id="hintBtn">힌트</button>
        <button class="btn" id="exportBtn">HTML 다운로드</button>
      </div>
      <div class="smalltext">청화고의 수상한 동아리, 비밀을 파헤치세요.</div>
    </section>
  </main>

  <footer>
    <div class="smalltext">오프라인 실행 가능 — 새로고침 시 초기화됩니다.</div>
    <div class="smalltext">버전: 수상한 동아리 v1.0</div>
  </footer>
</div>

<script>
function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function nowTime(){ return new Date().toLocaleTimeString(); }

let state = {
  current: 'intro',
  trust: 0,
  clues: 0,
  alert: 0,
  timeStart: Date.now(),
  history: [],
  flags:{}
};

function appendLog(text){
  const p=document.createElement('div');
  p.textContent=`[${nowTime()}] ${text}`;
  document.getElementById('log').prepend(p);
}

const story = {
  intro: {
    title:'전학생의 첫날',
    text:`청화고 기숙사에서 눈을 뜬 당신. 밤새 바람소리에 뒤척였지만 첫 등교일이라 설렌다.
과학부 유진과 미스터리 동아리 하린이 각각 다가와 서로 다른 제안을 한다.
누구를 따라갈까?`,
    choices:[
      {text:'과학부 유진 따라가기', id:'science_club', effect:(s)=>s.trust+=1},
      {text:'미스터리 동아리 하린 따라가기', id:'mystery_club', effect:(s)=>s.trust+=1}
    ]
  },
  science_club: {
    title:'과학부 실험실',
    text:`유진은 친절하지만 왠지 모르게 지나치게 학교 실험실에 집착한다.
지하실 출입 카드를 보여주며 은근히 자랑한다.
지하실에 뭔가 있는 것 같지만, 바로 묻기는 위험하다.`,
    choices:[
      {text:'카드를 몰래 훔친다', id:'steal_card', effect:(s)=>s.clues+=1},
      {text:'정중히 부탁해보기', id:'ask_card', effect:(s)=>s.trust+=1}
    ]
  },
  mystery_club: {
    title:'미스터리 동아리실',
    text:`하린은 학교에 숨겨진 음모를 조사 중이라며 열정적으로 설명한다.
과학부가 비밀 실험을 벌이고 있다고 한다.
증거를 모을까, 아니면 직접 지하실로 잠입할까?`,
    choices:[
      {text:'증거를 더 모은다', id:'gather_clues', effect:(s)=>s.clues+=1},
      {text:'몰래 잠입 시도', id:'sneak_basement', effect:(s)=>s.alert+=1}
    ]
  },
  steal_card: {
    title:'카드 탈취',
    text:`숨을 죽이고 카드를 훔쳤다. 유진은 모른 척한 것 같지만, 감시 카메라가 당신을 찍었을 수도 있다.
지하실 진입 가능.`,
    choices:[
      {text:'지하실로 이동', id:'basement', effect:(s)=>s.clues+=1},
      {text:'증거를 먼저 모은다', id:'gather_clues'}
    ]
  },
  ask_card: {
    title:'카드 부탁',
    text:`유진은 잠시 고민하다가 작은 목소리로 속삭인다. "지하실엔 가지 않는 게 좋아. 하지만... 네가 원하면." 카드를 받았다.
유진의 신뢰도가 올라갔다.`,
    choices:[
      {text:'지하실로 이동', id:'basement'},
      {text:'하린에게 알리기', id:'mystery_club', effect:(s)=>s.trust+=1}
    ]
  },
  gather_clues: {
    title:'단서 수집',
    text:`학교 곳곳을 돌아다니며 이상한 점을 메모했다.
감시 카메라, 잠긴 문, 이상한 전기음... 뭔가 분명 숨기고 있다.
단서를 충분히 모으면 지하실의 진실을 알 수 있을 것이다.`,
    choices:[
      {text:'지하실로 이동', id:'basement'},
      {text:'하린에게 보고', id:'mystery_club'}
    ]
  },
  sneak_basement: {
    title:'지하 잠입',
    text:`손전등을 들고 지하실로 내려갔다. 축축한 공기와 전자음, 알 수 없는 냄새.
문 너머에서 이상한 목소리가 들린다.
들어갈까, 도망칠까?`,
    choices:[
      {text:'문 열기', id:'basement'},
      {text:'뒤로 물러나기', id:'intro'}
    ]
  },
  basement: {
    title:'비밀 실험실',
    text:`지하 문이 열리자 수많은 전선과 커다란 원통 안에서 잠든 사람들.
청화고는 사실 비밀 실험장이었다.
당신의 선택에 따라 결말이 달라진다.`,
    choices:[
      {text:'진실을 밝힌다', id:'ending_truth'},
      {text:'모든 걸 숨긴 채 돌아간다', id:'ending_normal'}
    ]
  },
  ending_truth: {
    title:'엔딩 — 진실 발견',
    text:`당신은 루미너스 네트워크에 정보를 넘겨 학교의 실험을 폭로했다.
청화고는 폐쇄되고, 세상은 진실을 알게 된다.
그러나 누군가 당신을 주시하고 있다...`,
    choices:[{text:'다시 시작',id:'intro'}]
  },
  ending_normal: {
    title:'엔딩 — 평범한 졸업',
    text:`당신은 아무것도 모른 척 지냈다. 몇 년 후 졸업.
그러나 밤마다 지하실에서 깨어나는 목소리가 귓가에 맴돈다...`,
    choices:[{text:'다시 시작',id:'intro'}]
  }
};

const storyEl=document.getElementById('story');
const choicesEl=document.getElementById('choices');
const timePlayedEl=document.getElementById('timePlayed');
const progressText=document.getElementById('progressText');
const statTrust=document.getElementById('statTrust');
const statClues=document.getElementById('statClues');
const statAlert=document.getElementById('statAlert');

function renderHUD(){
  state.timePlayed=Math.floor((Date.now()-state.timeStart)/1000);
  timePlayedEl.textContent=`플레이: ${state.timePlayed}s`;
  const visited=new Set(state.history.concat([state.current]));
  progressText.textContent=`진행: ${Math.min(100,Math.floor((visited.size/Object.keys(story).length)*100))}%`;
  statTrust.textContent=`신뢰도: ${state.trust}`;
  statClues.textContent=`단서: ${state.clues}`;
  statAlert.textContent=`감시레벨: ${state.alert}`;
}

function render(){
  if(!state.current) state.current='intro';
  const node=story[state.current];
  renderHUD();

  if(!node){
    storyEl.textContent='오류: 해당 씬 없음';
    choicesEl.innerHTML='<div class="choice small">게임 오류. 다시 시작하세요.</div>';
    return;
  }

  storyEl.style.opacity=0;
  setTimeout(()=>{
    storyEl.textContent=node.text;
    storyEl.style.opacity=1;
  },140);

  choicesEl.innerHTML='';
  node.choices.forEach(c=>{
    const btn=document.createElement('button');
    btn.className='choice';
    btn.innerText=c.text;
    btn.onclick=()=>choose(c);
    choicesEl.appendChild(btn);
  });
}

function choose(choice){
  if(choice.effect && typeof choice.effect==='function'){
    try{choice.effect(state);}catch(e){console.error(e);}
  }
  state.history.push(state.current);
  state.current=choice.id;
  appendLog(`선택: ${choice.text}`);
  render();
}

document.getElementById('restartBtn').onclick=()=>{
  if(confirm('처음부터 시작하시겠습니까?')){
    state={current:'intro',trust:0,clues:0,alert:0,flags:{},history:[],timeStart:Date.now()};
    render();
    appendLog('게임 재시작');
  }
};

document.getElementById('hintBtn').onclick=()=>{
  let hint='단서를 모아 지하실 비밀을 밝히세요.';
  if(state.current==='intro') hint='누구를 믿을지 선택하세요.';
  if(state.clues>=2) hint='충분한 단서를 모았습니다. 지하실로 이동해보세요.';
  alert('힌트: '+hint);
};

document.getElementById('exportBtn').onclick=()=>{
  const blob=new Blob([document.documentElement.outerHTML],{type:'text/html'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download='suspicious_club.html';
  a.click();
  URL.revokeObjectURL(url);
};

render();
</script>
</body>
</html>
